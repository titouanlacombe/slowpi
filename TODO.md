switch to rayon for multi-threaded
